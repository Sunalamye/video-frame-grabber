<!doctype html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Crect width='64' height='64' rx='12' fill='%231a1a2e'/%3E%3Cpolygon points='24,16 24,48 50,32' fill='%23e94560'/%3E%3Crect x='8' y='44' width='48' height='4' rx='2' fill='%230f3460'/%3E%3Crect x='12' y='44' width='8' height='4' rx='2' fill='%23e94560'/%3E%3Crect x='24' y='44' width='8' height='4' rx='2' fill='%23e94560'/%3E%3Crect x='40' y='44' width='8' height='4' rx='2' fill='%23e94560'/%3E%3C/svg%3E" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Browser-based video frame extraction tool. Navigate frame-by-frame, capture high-quality screenshots, and export as ZIP — all processing happens locally." />
    <meta name="theme-color" content="#1a1a2e" />
    <meta property="og:title" content="Video Frame Grabber" />
    <meta property="og:description" content="Extract frames from any video right in your browser. No uploads, no servers — 100% local processing." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://sunalamye.github.io/video-frame-grabber/" />
    <title>Video Frame Grabber — Extract Frames from Any Video</title>
    <script type="module" crossorigin>(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();const l=t=>document.querySelector(t);function x(t){if(!isFinite(t)||t<0)return"00:00.000";const e=Math.floor(t/60),n=Math.floor(t%60),i=Math.floor(t%1*1e3);return`${String(e).padStart(2,"0")}:${String(n).padStart(2,"0")}.${String(i).padStart(3,"0")}`}function yt(t){if(!isFinite(t)||t<0)return"00m00s000";const e=Math.floor(t/60),n=Math.floor(t%60),i=Math.floor(t%1*1e3);return`${String(e).padStart(2,"0")}m${String(n).padStart(2,"0")}s${String(i).padStart(3,"0")}`}function L(t,e="info",n=3e3){const i=l("#notifications"),r=document.createElement("div");r.className=`notification ${e}`,r.textContent=t,i.appendChild(r),setTimeout(()=>{r.style.opacity="0",r.style.transition="opacity 0.3s",setTimeout(()=>r.remove(),300)},n)}let R=null;function vt(t){const e=l("#drop-zone"),n=l("#file-input"),i=l("#video");e.addEventListener("click",()=>n.click()),e.addEventListener("dragover",r=>{r.preventDefault(),e.classList.add("drag-over")}),e.addEventListener("dragleave",()=>{e.classList.remove("drag-over")}),e.addEventListener("drop",r=>{r.preventDefault(),e.classList.remove("drag-over");const o=r.dataTransfer.files[0];o&&o.type.startsWith("video/")&&Q(o,i,t)}),n.addEventListener("change",()=>{const r=n.files[0];r&&(Q(r,i,t),n.value="")})}function Q(t,e,n){R&&URL.revokeObjectURL(R),R=URL.createObjectURL(t),e.src=R,e.addEventListener("loadedmetadata",()=>{n(e)},{once:!0})}let u,U,it,A,k=!1;function Ut(t){u=t,U=l("#seek-bar"),it=l("#time-display"),A=l("#btn-play"),U.max=u.duration,U.value=0,u.addEventListener("timeupdate",wt),u.addEventListener("play",()=>{A.textContent="⏸"}),u.addEventListener("pause",()=>{A.textContent="▶"}),u.addEventListener("ended",()=>{A.textContent="▶"}),U.addEventListener("input",()=>{k=!0,u.currentTime=Number(U.value)}),U.addEventListener("change",()=>{k=!1}),A.addEventListener("click",rt),G()}function wt(){k||(U.value=u.currentTime),G()}function G(){const t=x(u?u.currentTime:0),e=x(u?u.duration:0);it.textContent=`${t} / ${e}`}function rt(){u&&(u.paused||u.ended?u.play():u.pause())}function ot(){!k&&u&&(U.value=u.currentTime,G())}const St="video-frame-grabber",Lt=1,g="captures",N=30,Bt=10,at=.001,z=160,H=90,X=.7,Tt=50,Et=100,Ct=200,J=500,At=200;let p,y=N,E=!1;function xt(t){p=t,l("#btn-prev-frame").addEventListener("click",ct),l("#btn-next-frame").addEventListener("click",st),It(t)}function It(t){if(!("requestVideoFrameCallback"in HTMLVideoElement.prototype)){y=N,$();return}const e=[];let n=!1;function i(r,o){if(e.push(o.mediaTime),e.length>=Bt+1){const a=[];for(let s=1;s<e.length;s++){const f=e[s]-e[s-1];f>0&&a.push(f)}if(a.length>0){const s=a.reduce((f,d)=>f+d,0)/a.length;y=Math.round(1/s),(y<1||y>240)&&(y=N)}t.pause(),t.currentTime=0,n=!1,$();return}t.requestVideoFrameCallback(i)}t.addEventListener("canplay",()=>{n||(n=!0,t.currentTime,t.muted=!0,t.requestVideoFrameCallback(i),t.play().catch(()=>{y=N,n=!1,$()}))},{once:!0})}function $(){const t=l("#fps-display");t.textContent=`${y} FPS`}function st(){if(!p||E)return;p.pause(),E=!0;const t=1/y+at,e=Math.min(p.currentTime+t,p.duration);p.currentTime=e,p.addEventListener("seeked",()=>{E=!1,ot()},{once:!0})}function ct(){if(!p||E)return;p.pause(),E=!0;const t=1/y+at,e=Math.max(p.currentTime-t,0);p.currentTime=e,p.addEventListener("seeked",()=>{E=!1,ot()},{once:!0})}let m=null,V=null,h=null,q=null;function Mt(t,e){typeof OffscreenCanvas<"u"?((!m||m.width!==t||m.height!==e)&&(m=new OffscreenCanvas(t,e),V=m.getContext("2d")),h||(h=new OffscreenCanvas(z,H),q=h.getContext("2d"))):(m||(m=document.createElement("canvas"),V=m.getContext("2d")),m.width=t,m.height=e,h||(h=document.createElement("canvas"),h.width=z,h.height=H,q=h.getContext("2d")))}async function Ft(t){const{videoWidth:e,videoHeight:n}=t;Mt(e,n),V.drawImage(t,0,0,e,n),q.drawImage(t,0,0,z,H);let i,r;return m instanceof OffscreenCanvas?(i=await m.convertToBlob({type:"image/png"}),r=await h.convertToBlob({type:"image/jpeg",quality:X})):(i=await new Promise(o=>m.toBlob(o,"image/png")),r=await new Promise(o=>h.toBlob(o,"image/jpeg",X))),{fullBlob:i,thumbBlob:r,width:e,height:n,timestamp:t.currentTime,fileSize:i.size}}function Dt(){const t=l("#flash-overlay");t.classList.add("flash-active"),setTimeout(()=>{t.classList.remove("flash-active")},At)}let w=null;const S=new Map;async function lt(){return new Promise((t,e)=>{const n=indexedDB.open(St,Lt);n.onupgradeneeded=i=>{const r=i.target.result;r.objectStoreNames.contains(g)||r.createObjectStore(g,{keyPath:"id"}).createIndex("by-timestamp","timestamp",{unique:!1})},n.onsuccess=i=>{w=i.target.result,t(w)},n.onerror=i=>{e(i.target.error)}})}async function Rt(t){const e=crypto.randomUUID(),n={id:e,fullBlob:t.fullBlob,thumbBlob:t.thumbBlob,timestamp:t.timestamp,width:t.width,height:t.height,fileSize:t.fileSize,createdAt:Date.now()};return new Promise((i,r)=>{const o=w.transaction(g,"readwrite");o.objectStore(g).put(n),o.oncomplete=()=>{const s=URL.createObjectURL(t.thumbBlob);S.set(e,{thumbBlobUrl:s,timestamp:t.timestamp,fileSize:t.fileSize,createdAt:n.createdAt}),i({id:e,thumbBlobUrl:s,...n})},o.onerror=s=>r(s.target.error)})}async function Nt(t){return new Promise((e,n)=>{const i=w.transaction(g,"readwrite");i.objectStore(g).delete(t),i.oncomplete=()=>{const r=S.get(t);r&&(URL.revokeObjectURL(r.thumbBlobUrl),S.delete(t)),e()},i.onerror=r=>n(r.target.error)})}async function kt(){return new Promise((t,e)=>{const n=w.transaction(g,"readwrite");n.objectStore(g).clear(),n.oncomplete=()=>{for(const i of S.values())URL.revokeObjectURL(i.thumbBlobUrl);S.clear(),t()},n.onerror=i=>e(i.target.error)})}function ft(){return Array.from(S.entries()).map(([t,e])=>({id:t,...e})).sort((t,e)=>t.createdAt-e.createdAt)}async function Ot(t){return new Promise((e,n)=>{const r=w.transaction(g,"readonly").objectStore(g).get(t);r.onsuccess=()=>{e(r.result?r.result.fullBlob:null)},r.onerror=o=>n(o.target.error)})}function I(){let t=0,e=0;for(const n of S.values())t+=n.fileSize,e++;return{count:e,totalSizeMB:t/(1024*1024)}}async function Pt(){return w||await lt(),new Promise((t,e)=>{const n=w.transaction(g,"readonly"),r=n.objectStore(g).openCursor(),o=[];r.onsuccess=a=>{const s=a.target.result;if(s){const f=s.value,d=URL.createObjectURL(f.thumbBlob);S.set(f.id,{thumbBlobUrl:d,timestamp:f.timestamp,fileSize:f.fileSize,createdAt:f.createdAt}),o.push({id:f.id,thumbBlobUrl:d,timestamp:f.timestamp,fileSize:f.fileSize,createdAt:f.createdAt}),s.continue()}},n.oncomplete=()=>{o.sort((a,s)=>a.createdAt-s.createdAt),t(o)},n.onerror=a=>e(a.target.error)})}let W=null,Z=null;function $t(t,e){W=t,Z=e}function ut(t){const e=l("#thumbnail-list"),n=document.createElement("div");n.className="thumb-item",n.dataset.id=t.id,n.dataset.timestamp=t.timestamp,n.setAttribute("role","listitem");const i=document.createElement("img");i.src=t.thumbBlobUrl,i.alt=`幀 ${x(t.timestamp)}`;const r=document.createElement("div");r.className="thumb-time",r.textContent=x(t.timestamp);const o=document.createElement("button");o.className="thumb-delete",o.textContent="✕",o.setAttribute("aria-label",`刪除幀 ${x(t.timestamp)}`),o.addEventListener("click",async a=>{a.stopPropagation(),await Nt(t.id),n.remove(),Z&&Z()}),n.addEventListener("click",()=>{W&&(W.currentTime=t.timestamp)}),n.appendChild(i),n.appendChild(r),n.appendChild(o),e.appendChild(n),e.scrollLeft=e.scrollWidth}function _t(){const t=l("#thumbnail-list");t.innerHTML=""}"stream"in Blob.prototype||Object.defineProperty(Blob.prototype,"stream",{value(){return new Response(this).body}}),"setBigUint64"in DataView.prototype||Object.defineProperty(DataView.prototype,"setBigUint64",{value(t,e,n){const i=Number(0xffffffffn&e),r=Number(e>>32n);this.setUint32(t+(n?0:4),i,n),this.setUint32(t+(n?4:0),r,n)}});var C=t=>new DataView(new ArrayBuffer(t)),v=t=>new Uint8Array(t.buffer||t),T=t=>new TextEncoder().encode(String(t)),B=t=>Math.min(4294967295,Number(t)),tt=t=>Math.min(65535,Number(t));function jt(t,e,n){e===void 0||e instanceof Date||(e=new Date(e));const i=t!==void 0;if(n||(n=i?436:509),t instanceof File)return{isFile:i,t:e||new Date(t.lastModified),bytes:t.stream(),mode:n};if(t instanceof Response)return{isFile:i,t:e||new Date(t.headers.get("Last-Modified")||Date.now()),bytes:t.body,mode:n};if(e===void 0)e=new Date;else if(isNaN(e))throw new Error("Invalid modification date.");if(!i)return{isFile:i,t:e,mode:n};if(typeof t=="string")return{isFile:i,t:e,bytes:T(t),mode:n};if(t instanceof Blob)return{isFile:i,t:e,bytes:t.stream(),mode:n};if(t instanceof Uint8Array||t instanceof ReadableStream)return{isFile:i,t:e,bytes:t,mode:n};if(t instanceof ArrayBuffer||ArrayBuffer.isView(t))return{isFile:i,t:e,bytes:v(t),mode:n};if(Symbol.asyncIterator in t)return{isFile:i,t:e,bytes:dt(t[Symbol.asyncIterator]()),mode:n};throw new TypeError("Unsupported input format.")}function dt(t,e=t){return new ReadableStream({async pull(n){let i=0;for(;n.desiredSize>i;){const r=await t.next();if(!r.value){n.close();break}{const o=zt(r.value);n.enqueue(o),i+=o.byteLength}}},cancel(n){e.throw?.(n)}})}function zt(t){return typeof t=="string"?T(t):t instanceof Uint8Array?t:v(t)}function mt(t,e,n){let[i,r]=(function(o){return o?o instanceof Uint8Array?[o,1]:ArrayBuffer.isView(o)||o instanceof ArrayBuffer?[v(o),1]:[T(o),0]:[void 0,0]})(e);if(t instanceof File)return{i:_(i||T(t.name)),o:BigInt(t.size),u:r};if(t instanceof Response){const o=t.headers.get("content-disposition"),a=o&&o.match(/;\s*filename\*?\s*=\s*(?:UTF-\d+''|)["']?([^;"'\r\n]*)["']?(?:;|$)/i),s=a&&a[1]||t.url&&new URL(t.url).pathname.split("/").findLast(Boolean),f=s&&decodeURIComponent(s),d=n||+t.headers.get("content-length");return{i:_(i||T(f)),o:BigInt(d),u:r}}return i=_(i,t!==void 0||n!==void 0),typeof t=="string"?{i,o:BigInt(T(t).length),u:r}:t instanceof Blob?{i,o:BigInt(t.size),u:r}:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?{i,o:BigInt(t.byteLength),u:r}:{i,o:Ht(t,n),u:r}}function Ht(t,e){return e>-1?BigInt(e):t?void 0:0n}function _(t,e=1){if(!t||t.every((n=>n===47)))throw new Error("The file must have a name.");if(e)for(;t[t.length-1]===47;)t=t.subarray(0,-1);else t[t.length-1]!==47&&(t=new Uint8Array([...t,47]));return t}var pt=new Uint32Array(256);for(let t=0;t<256;++t){let e=t;for(let n=0;n<8;++n)e=e>>>1^(1&e&&3988292384);pt[t]=e}function et(t,e=0){e=~e;for(var n=0,i=t.length;n<i;n++)e=e>>>8^pt[255&e^t[n]];return~e>>>0}function gt(t,e,n=0){const i=t.getSeconds()>>1|t.getMinutes()<<5|t.getHours()<<11,r=t.getDate()|t.getMonth()+1<<5|t.getFullYear()-1980<<9;e.setUint16(n,i,1),e.setUint16(n+2,r,1)}function Vt({i:t,u:e},n){return 8*(!e||(n??(function(i){try{qt.decode(i)}catch{return 0}return 1})(t)))}var qt=new TextDecoder("utf8",{fatal:1});function Wt(t,e=0){const n=C(30);return n.setUint32(0,1347093252),n.setUint32(4,754976768|e),gt(t.t,n,10),n.setUint16(26,t.i.length,1),v(n)}async function*Zt(t){let{bytes:e}=t;if("then"in e&&(e=await e),e instanceof Uint8Array)yield e,t.l=et(e,0),t.o=BigInt(e.length);else{t.o=0n;const n=e.getReader();for(;;){const{value:i,done:r}=await n.read();if(r)break;t.l=et(i,t.l),t.o+=BigInt(i.length),yield i}}}function Kt(t,e){const n=C(16+(e?8:0));return n.setUint32(0,1347094280),n.setUint32(4,t.isFile?t.l:0,1),e?(n.setBigUint64(8,t.o,1),n.setBigUint64(16,t.o,1)):(n.setUint32(8,B(t.o),1),n.setUint32(12,B(t.o),1)),v(n)}function Yt(t,e,n=0,i=0){const r=C(46);return r.setUint32(0,1347092738),r.setUint32(4,755182848),r.setUint16(8,2048|n),gt(t.t,r,12),r.setUint32(16,t.isFile?t.l:0,1),r.setUint32(20,B(t.o),1),r.setUint32(24,B(t.o),1),r.setUint16(28,t.i.length,1),r.setUint16(30,i,1),r.setUint16(40,t.mode|(t.isFile?32768:16384),1),r.setUint32(42,B(e),1),v(r)}function Gt(t,e,n){const i=C(n);return i.setUint16(0,1,1),i.setUint16(2,n-4,1),16&n&&(i.setBigUint64(4,t.o,1),i.setBigUint64(12,t.o,1)),i.setBigUint64(n-8,e,1),v(i)}function ht(t){return t instanceof File||t instanceof Response?[[t],[t]]:[[t.input,t.name,t.size],[t.input,t.lastModified,t.mode]]}var Qt=t=>(function(e){let n=BigInt(22),i=0n,r=0;for(const o of e){if(!o.i)throw new Error("Every file must have a non-empty name.");if(o.o===void 0)throw new Error(`Missing size for file "${new TextDecoder().decode(o.i)}".`);const a=o.o>=0xffffffffn,s=i>=0xffffffffn;i+=BigInt(46+o.i.length+(a&&8))+o.o,n+=BigInt(o.i.length+46+(12*s|28*a)),r||(r=a)}return(r||i>=0xffffffffn)&&(n+=BigInt(76)),n+i})((function*(e){for(const n of e)yield mt(...ht(n)[0])})(t));function Xt(t,e={}){const n={"Content-Type":"application/zip","Content-Disposition":"attachment"};return(typeof e.length=="bigint"||Number.isInteger(e.length))&&e.length>0&&(n["Content-Length"]=String(e.length)),e.metadata&&(n["Content-Length"]=String(Qt(e.metadata))),new Response(Jt(t,e),{headers:n})}function Jt(t,e={}){const n=(function(i){const r=i[Symbol.iterator in i?Symbol.iterator:Symbol.asyncIterator]();return{async next(){const o=await r.next();if(o.done)return o;const[a,s]=ht(o.value);return{done:0,value:Object.assign(jt(...s),mt(...a))}},throw:r.throw?.bind(r),[Symbol.asyncIterator](){return this}}})(t);return dt((async function*(i,r){const o=[];let a=0n,s=0n,f=0;for await(const c of i){const F=Vt(c,r.buffersAreUTF8);yield Wt(c,F),yield new Uint8Array(c.i),c.isFile&&(yield*Zt(c));const D=c.o>=0xffffffffn,P=12*(a>=0xffffffffn)|28*D;yield Kt(c,D),o.push(Yt(c,a,F,P)),o.push(c.i),P&&o.push(Gt(c,a,P)),D&&(a+=8n),s++,a+=BigInt(46+c.i.length)+c.o,f||(f=D)}let d=0n;for(const c of o)yield c,d+=BigInt(c.length);if(f||a>=0xffffffffn){const c=C(76);c.setUint32(0,1347094022),c.setBigUint64(4,BigInt(44),1),c.setUint32(12,755182848),c.setBigUint64(24,s,1),c.setBigUint64(32,s,1),c.setBigUint64(40,d,1),c.setBigUint64(48,a,1),c.setUint32(56,1347094023),c.setBigUint64(64,a+d,1),c.setUint32(72,1,1),yield v(c)}const b=C(22);b.setUint32(0,1347093766),b.setUint16(8,tt(s),1),b.setUint16(10,tt(s),1),b.setUint32(12,B(d),1),b.setUint32(16,B(a),1),yield v(b)})(n,e),n)}function te(){const t=new Date,e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),r=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0"),a=String(t.getSeconds()).padStart(2,"0");return`frames_${e}${n}${i}_${r}${o}${a}`}async function ee(){const t=ft();if(t.length===0)return;const e=te(),n=prompt("請輸入 ZIP 檔案名稱：",e);if(n===null)return;const i=(n.trim()||e)+".zip";async function*r(){for(let f=0;f<t.length;f++){const d=t[f],b=await Ot(d.id);if(b){const c=String(f+1).padStart(4,"0"),F=yt(d.timestamp);yield{name:`frame_${c}_${F}.png`,input:b}}}}const o=await Xt(r()).blob(),a=URL.createObjectURL(o),s=document.createElement("a");s.href=a,s.download=i,document.body.appendChild(s),s.click(),s.remove(),URL.revokeObjectURL(a)}let K=null;function ne(t){K=t,document.addEventListener("keydown",ie)}function ie(t){const e=t.target.tagName;if(!(e==="INPUT"||e==="TEXTAREA"||e==="SELECT"))switch(t.code){case"Space":t.preventDefault(),rt();break;case"ArrowRight":t.preventDefault(),st();break;case"ArrowLeft":t.preventDefault(),ct();break;case"KeyS":t.preventDefault(),K&&K();break}}let Y=0;function re(){const{count:t,totalSizeMB:e}=I();let n=0;e>=J?n=3:t>=Et||e>=Ct?n=2:t>=Tt&&(n=1),n>Y&&(n===1?L(`已截取 ${t} 幀。截取過多可能影響效能。`,"info",4e3):n===2?L(`已使用 ${e.toFixed(0)} MB（${t} 幀）。建議匯出後清除以釋放空間。`,"warning",6e3):n===3&&L(`儲存已超過 ${J} MB！請立即匯出並清除，以避免瀏覽器崩潰。`,"danger",1e4),Y=n)}function oe(){Y=0}const ae=`<!doctype html>
`+document.documentElement.outerHTML;let bt=!1,j=!1;async function se(){await lt();const t=await Pt();vt(ce),l("#btn-export").addEventListener("click",fe),l("#btn-clear").addEventListener("click",ue),l("#btn-download-offline").addEventListener("click",de),t.length>0&&(O(),M())}function ce(t){l("#drop-zone").classList.add("hidden"),l("#video-container").classList.remove("hidden"),l("#controls").classList.remove("hidden"),l("#thumbnail-strip").classList.remove("hidden"),l("#shortcuts-hint").classList.remove("hidden"),["#btn-play","#btn-prev-frame","#btn-next-frame","#btn-capture"].forEach(n=>l(n).removeAttribute("disabled")),Ut(t),xt(t),$t(t,()=>{O(),M()}),le(),ne(()=>nt(t)),l("#btn-capture").addEventListener("click",()=>nt(t)),bt=!0,setTimeout(()=>{l("#shortcuts-hint").classList.add("hidden")},5e3)}function le(){const{count:t}=I();t>0&&ft().forEach(n=>ut(n))}async function nt(t){if(!(j||!bt)){j=!0;try{t.pause(),Dt();const e=await Ft(t),n=await Rt(e);ut(n),O(),M(),re()}catch(e){L("截圖失敗："+e.message,"danger")}finally{j=!1}}}async function fe(){const t=l("#btn-export");t.disabled=!0,t.textContent="匯出中...";try{await ee(),L("ZIP 匯出完成！","info")}catch(e){L("匯出失敗："+e.message,"danger")}finally{t.disabled=!1,t.textContent="匯出 ZIP",M()}}async function ue(){const{count:t}=I();t!==0&&confirm(`確定要清除全部 ${t} 張截圖嗎？此操作無法復原。`)&&(await kt(),_t(),O(),M(),oe(),L("已清除全部截圖","info"))}function de(){const t=new Blob([ae],{type:"text/html;charset=utf-8"}),e=URL.createObjectURL(t),n=document.createElement("a");n.href=e,n.download="video-frame-grabber.html",document.body.appendChild(n),n.click(),n.remove(),URL.revokeObjectURL(e)}function O(){const{count:t}=I();l("#capture-count").textContent=`${t} 幀`}function M(){const{count:t}=I();l("#btn-export").disabled=t===0,l("#btn-clear").disabled=t===0}se().catch(t=>{console.error("Init failed:",t)});</script>
    <style rel="stylesheet" crossorigin>*,*:before,*:after{box-sizing:border-box;margin:0;padding:0}:root{--color-bg: #0c0c1d;--color-surface: rgba(22, 33, 62, .85);--color-surface-solid: #16213e;--color-surface-alt: #0f3460;--color-surface-hover: #1a3a6e;--color-primary: #e94560;--color-primary-hover: #ff6b81;--color-primary-glow: rgba(233, 69, 96, .3);--color-text: #f0f0f5;--color-text-muted: #8892b0;--color-border: rgba(255, 255, 255, .08);--color-success: #2ecc71;--color-warning: #f39c12;--color-danger: #e74c3c;--color-flash: rgba(255, 255, 255, .85);--radius: 10px;--radius-sm: 6px;--radius-lg: 16px;--shadow: 0 4px 24px rgba(0, 0, 0, .4);--shadow-sm: 0 2px 8px rgba(0, 0, 0, .3);--shadow-glow: 0 0 20px var(--color-primary-glow);--font-mono: "SF Mono", "Fira Code", "Cascadia Code", "JetBrains Mono", monospace;--font-sans: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;--header-height: 56px;--controls-height: 72px;--thumbnail-strip-height: 128px;--transition-fast: .15s cubic-bezier(.4, 0, .2, 1);--transition-normal: .25s cubic-bezier(.4, 0, .2, 1)}html,body{height:100%;font-family:var(--font-sans);background:var(--color-bg);color:var(--color-text);overflow:hidden;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}button{font-family:inherit;cursor:pointer;border:none;background:none;color:inherit;transition:all var(--transition-fast)}button:disabled{opacity:.35;cursor:not-allowed}button:focus-visible{outline:2px solid var(--color-primary);outline-offset:2px}input[type=range]{-webkit-appearance:none;appearance:none;width:100%;height:5px;background:var(--color-border);border-radius:4px;outline:none;transition:background var(--transition-fast)}input[type=range]:hover{background:#ffffff1f}input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:16px;height:16px;border-radius:50%;background:var(--color-primary);cursor:pointer;box-shadow:0 0 8px var(--color-primary-glow);transition:transform var(--transition-fast),box-shadow var(--transition-fast)}input[type=range]::-webkit-slider-thumb:hover{transform:scale(1.2);box-shadow:0 0 16px var(--color-primary-glow)}input[type=range]::-moz-range-thumb{width:16px;height:16px;border-radius:50%;background:var(--color-primary);cursor:pointer;border:none;box-shadow:0 0 8px var(--color-primary-glow)}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}.hidden{display:none!important}#header{height:var(--header-height);background:var(--color-surface);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);display:flex;align-items:center;justify-content:space-between;padding:0 20px;border-bottom:1px solid var(--color-border);position:relative;z-index:10}#header h1{font-size:17px;font-weight:700;letter-spacing:-.2px;background:linear-gradient(135deg,var(--color-text) 0%,var(--color-primary-hover) 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.header-right{display:flex;align-items:center;gap:10px}.badge{background:var(--color-surface-alt);padding:5px 14px;border-radius:20px;font-size:12px;font-family:var(--font-mono);font-weight:500;border:1px solid var(--color-border);letter-spacing:.3px}#btn-export,#btn-clear,#btn-download-offline{padding:7px 18px;border-radius:20px;font-size:13px;font-weight:600;letter-spacing:.2px;border:1px solid transparent}#btn-export{background:var(--color-primary);box-shadow:var(--shadow-glow)}#btn-export:not(:disabled):hover{background:var(--color-primary-hover);box-shadow:0 0 28px var(--color-primary-glow);transform:translateY(-1px)}#btn-export:not(:disabled):active{transform:translateY(0)}#btn-clear{background:transparent;border-color:var(--color-border)}#btn-clear:not(:disabled):hover{background:var(--color-danger);border-color:var(--color-danger)}#btn-download-offline{background:transparent;border-color:var(--color-border)}#btn-download-offline:hover{background:var(--color-surface-alt);border-color:var(--color-surface-hover)}#main-area{height:calc(100vh - var(--header-height) - var(--controls-height) - var(--thumbnail-strip-height));display:flex;align-items:center;justify-content:center;background:radial-gradient(ellipse at center,#0d0d25,#000);position:relative;overflow:hidden}#drop-zone{display:flex;align-items:center;justify-content:center;width:100%;height:100%;cursor:pointer;transition:background var(--transition-normal)}#drop-zone:hover .drop-content svg{opacity:.7;transform:translateY(-2px)}#drop-zone.drag-over{background:#e945600f}#drop-zone.drag-over .drop-content{border-color:var(--color-primary);background:#e945600a}.drop-content{text-align:center;color:var(--color-text-muted);padding:48px 64px;border:2px dashed rgba(255,255,255,.1);border-radius:var(--radius-lg);transition:all var(--transition-normal)}.drop-content svg{margin-bottom:20px;opacity:.4;transition:all var(--transition-normal);stroke:var(--color-primary)}.drop-content p{font-size:17px;margin-bottom:8px;font-weight:500}.drop-hint{font-size:14px!important;font-weight:400!important;opacity:.5}.privacy-note{font-size:12px!important;opacity:.3;margin-top:20px!important;display:flex;align-items:center;justify-content:center;gap:6px}#video-container{width:100%;height:100%;display:flex;align-items:center;justify-content:center;position:relative}#video{max-width:100%;max-height:100%;display:block;border-radius:2px}#flash-overlay{position:absolute;inset:0;background:var(--color-flash);opacity:0;pointer-events:none;transition:opacity .06s ease-in}#flash-overlay.flash-active{opacity:1;transition:none}#controls{height:var(--controls-height);background:var(--color-surface);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border-top:1px solid var(--color-border);padding:0 20px;display:flex;flex-direction:column;justify-content:center;gap:8px}.seek-row{padding:0 2px}.controls-row{display:flex;align-items:center;justify-content:space-between}.controls-left,.controls-right{display:flex;align-items:center;gap:6px}.controls-left button,.controls-right button{font-size:15px;padding:6px 10px;border-radius:var(--radius-sm)}.controls-left button:not(:disabled):hover,.controls-right button:not(:disabled):hover{background:var(--color-surface-alt)}.controls-left button:not(:disabled):active,.controls-right button:not(:disabled):active{transform:scale(.95)}#btn-capture{background:var(--color-primary)!important;padding:6px 20px!important;font-weight:600;border-radius:20px!important;box-shadow:var(--shadow-glow);letter-spacing:.3px}#btn-capture:not(:disabled):hover{background:var(--color-primary-hover)!important;box-shadow:0 0 24px var(--color-primary-glow);transform:translateY(-1px)}#btn-capture:not(:disabled):active{transform:translateY(0) scale(.97)}.time-display{font-family:var(--font-mono);font-size:12px;color:var(--color-text-muted);margin-left:10px;letter-spacing:.5px}.fps-display{font-family:var(--font-mono);font-size:11px;color:var(--color-text-muted);background:#ffffff0d;padding:3px 10px;border-radius:12px;border:1px solid var(--color-border)}#thumbnail-strip{height:var(--thumbnail-strip-height);background:var(--color-surface);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border-top:1px solid var(--color-border);padding:10px 20px;overflow:hidden}#thumbnail-list{display:flex;gap:10px;height:100%;overflow-x:auto;overflow-y:hidden;scroll-behavior:smooth;-webkit-overflow-scrolling:touch}#thumbnail-list::-webkit-scrollbar{height:4px}#thumbnail-list::-webkit-scrollbar-track{background:transparent}#thumbnail-list::-webkit-scrollbar-thumb{background:#ffffff1a;border-radius:4px}#thumbnail-list::-webkit-scrollbar-thumb:hover{background:#fff3}.thumb-item{flex-shrink:0;width:148px;height:100%;position:relative;border-radius:var(--radius);overflow:hidden;cursor:pointer;border:2px solid transparent;transition:all var(--transition-fast);background:var(--color-surface-alt)}.thumb-item:hover{border-color:var(--color-primary);box-shadow:0 0 12px var(--color-primary-glow);transform:translateY(-2px)}.thumb-item img{width:100%;height:82px;object-fit:cover;display:block}.thumb-time{font-family:var(--font-mono);font-size:10px;text-align:center;padding:3px 0;background:#0009;color:var(--color-text-muted);letter-spacing:.3px}.thumb-delete{position:absolute;top:4px;right:4px;width:22px;height:22px;border-radius:50%;background:#000000bf;color:var(--color-danger);font-size:12px;display:flex;align-items:center;justify-content:center;opacity:0;transition:all var(--transition-fast);backdrop-filter:blur(4px)}.thumb-item:hover .thumb-delete{opacity:1}.thumb-delete:hover{background:var(--color-danger);color:#fff;transform:scale(1.1)}#notifications{position:fixed;top:calc(var(--header-height) + 12px);right:20px;display:flex;flex-direction:column;gap:8px;z-index:100;pointer-events:none}.notification{padding:12px 18px;border-radius:var(--radius);font-size:13px;font-weight:500;box-shadow:var(--shadow);pointer-events:auto;animation:notif-in .35s cubic-bezier(.16,1,.3,1);max-width:340px;backdrop-filter:blur(16px);-webkit-backdrop-filter:blur(16px)}.notification.info{background:#0f3460e6;border-left:3px solid var(--color-primary)}.notification.warning{background:#3d2e0ae6;border-left:3px solid var(--color-warning);color:var(--color-warning)}.notification.danger{background:#3d0a0ae6;border-left:3px solid var(--color-danger);color:var(--color-danger)}@keyframes notif-in{0%{opacity:0;transform:translate(24px) scale(.96)}to{opacity:1;transform:translate(0) scale(1)}}#shortcuts-hint{position:fixed;bottom:calc(var(--thumbnail-strip-height) + var(--controls-height) + 12px);left:50%;transform:translate(-50%);display:flex;gap:20px;background:#000000bf;backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);padding:8px 20px;border-radius:20px;font-size:12px;color:var(--color-text-muted);z-index:50;pointer-events:none;border:1px solid var(--color-border);animation:hint-fade .4s ease-out}@keyframes hint-fade{0%{opacity:0;transform:translate(-50%) translateY(8px)}to{opacity:1;transform:translate(-50%) translateY(0)}}</style>
  </head>
  <body>
    <div id="app">
      <!-- Header -->
      <header id="header">
        <div class="header-left">
          <h1>Video Frame Grabber</h1>
        </div>
        <div class="header-right">
          <span id="capture-count" class="badge" aria-label="已截取幀數">0 幀</span>
          <button id="btn-export" disabled aria-label="匯出 ZIP">匯出 ZIP</button>
          <button id="btn-clear" disabled aria-label="清除全部截圖">清除全部</button>
          <button id="btn-download-offline" aria-label="下載離線版">⬇ 離線版</button>
        </div>
      </header>

      <!-- Drop zone / Video container -->
      <main id="main-area">
        <div id="drop-zone" aria-label="拖放影片檔案至此處">
          <div class="drop-content">
            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/>
              <polyline points="17 8 12 3 7 8"/>
              <line x1="12" y1="3" x2="12" y2="15"/>
            </svg>
            <p>拖放影片檔案至此處</p>
            <p class="drop-hint">或點擊選擇檔案</p>
            <p class="privacy-note">所有處理均在本機完成，影片不會上傳</p>
          </div>
          <input type="file" id="file-input" accept="video/*" class="sr-only" aria-label="選擇影片檔案" />
        </div>

        <div id="video-container" class="hidden">
          <video id="video" playsinline></video>
          <div id="flash-overlay" aria-hidden="true"></div>
        </div>
      </main>

      <!-- Player controls -->
      <div id="controls" class="hidden">
        <div class="seek-row">
          <input type="range" id="seek-bar" min="0" max="100" step="any" value="0" aria-label="影片進度" />
        </div>
        <div class="controls-row">
          <div class="controls-left">
            <button id="btn-prev-frame" aria-label="上一幀 (←)" disabled>⏮</button>
            <button id="btn-play" aria-label="播放/暫停 (Space)" disabled>▶</button>
            <button id="btn-next-frame" aria-label="下一幀 (→)" disabled>⏭</button>
            <span id="time-display" class="time-display">00:00.000 / 00:00.000</span>
          </div>
          <div class="controls-right">
            <span id="fps-display" class="fps-display">-- FPS</span>
            <button id="btn-capture" aria-label="截圖 (S)" disabled>截圖</button>
          </div>
        </div>
      </div>

      <!-- Thumbnail strip -->
      <div id="thumbnail-strip" class="hidden">
        <div id="thumbnail-list" role="list" aria-label="已截取的幀"></div>
      </div>

      <!-- Notification area -->
      <div id="notifications" aria-live="polite"></div>
    </div>

    <!-- Keyboard shortcuts hint -->
    <div id="shortcuts-hint" class="hidden">
      <span>Space: 播放/暫停</span>
      <span>← →: 逐幀</span>
      <span>S: 截圖</span>
    </div>

  </body>
</html>
